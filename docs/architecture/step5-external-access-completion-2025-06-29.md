# Step 5: ì™¸ë¶€ ì ‘ê·¼ ì™„ì„± ë° í†µí•© ê´€ì°°ê°€ëŠ¥ì„± í”Œë«í¼ ê²€ì¦

**ì‘ì—… ë‚ ì§œ**: 2025ë…„ 6ì›” 29ì¼  

---

## ğŸ¯ **Situation (ìƒí™©)**

**ë°°ê²½**
- Step 4ì—ì„œ í†µí•© ê´€ì°°ê°€ëŠ¥ì„± í”Œë«í¼ì˜ í•µì‹¬ì„ ë§Œë“¤ì—ˆìŒ (95% ë‹¬ì„±)
- **ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ì—†ì–´ì„œ** ì‹¤ë¬´ì—ì„œ í™œìš©í•˜ê¸° ì–´ë ¤ì›€
- Self-managed Kubernetes í™˜ê²½ì˜ **ë„¤íŠ¸ì›Œí‚¹ì´ ë³µì¡í•œ** ë¬¸ì œì— ì§ë©´
- ë§¤ì¼ ë°˜ë³µí•˜ëŠ” í”„ë¡œì íŠ¸ íŒ¨í„´ì—ì„œ **ì™„ì „í•œ ë§ˆë¬´ë¦¬**ê°€ í•„ìš”

**í•´ê²°í•´ì•¼ í•  ë¬¸ì œë“¤**
- **Self-managed í™˜ê²½ì˜ ì œì•½**: kubectl exec, port-forward ì œí•œ
- **kube-proxy NodePort ë°”ì¸ë”©ì´ ì‹¤íŒ¨í•¨**: í¬íŠ¸ê°€ ì „í˜€ ë°”ì¸ë”©ë˜ì§€ ì•ŠìŒ
- **AWS ë³´ì•ˆê·¸ë£¹**: 30080, 30300 í¬íŠ¸ê°€ ì—´ë ¤ìˆì§€ ì•ŠìŒ
- **Pod ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬**: ë§ˆìŠ¤í„°ë…¸ë“œ â†’ Pod ì§ì ‘ í†µì‹  ë¶ˆê°€

**í•„ìš”í•œ ê²ƒë“¤**
- ì›¹ ë¸Œë¼ìš°ì €ë¡œ **ì™„ì „í•œ ì™¸ë¶€ ì ‘ê·¼**ì´ ë˜ì–´ì•¼ í•¨
- **Bookinfo ì• í”Œë¦¬ì¼€ì´ì…˜**ê³¼ **Grafana ëŒ€ì‹œë³´ë“œ**ë¥¼ ì™¸ë¶€ì— ë…¸ì¶œ
- **í”„ë¡œë•ì…˜ê¸‰ ì ‘ê·¼ì„±**: ì‹¤ì œ ì‚¬ìš©ìê°€ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€

## ğŸ“‹ **Task (ê³¼ì œ)**

**ëª©í‘œ**
- **Self-managed í™˜ê²½ ë„¤íŠ¸ì›Œí‚¹ ì œì•½**ì„ ì™„ì „íˆ ê·¹ë³µí•˜ê¸°
- **AWS ë³´ì•ˆê·¸ë£¹ + Kubernetes ë„¤íŠ¸ì›Œí‚¹**ì„ í†µí•©í•´ì„œ í•´ê²°í•˜ê¸°
- **ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê´€ì°°ê°€ëŠ¥ì„± í”Œë«í¼** ì™„ì„±í•˜ê¸°

**ì„±ê³µí–ˆë‹¤ê³  ë³¼ ìˆ˜ ìˆëŠ” ê¸°ì¤€**
- âœ… Bookinfo ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì›¹ ë¸Œë¼ìš°ì €ë¡œ ì ‘ê·¼ ê°€ëŠ¥ (HTTP 200)
- âœ… Grafana ëŒ€ì‹œë³´ë“œì— ì›¹ ë¸Œë¼ìš°ì €ë¡œ ì ‘ê·¼ ê°€ëŠ¥ (ë¡œê·¸ì¸ í˜ì´ì§€)
- âœ… ì•ˆì •ì ì´ê³  ì¬í˜„ ê°€ëŠ¥í•œ ì™¸ë¶€ ì ‘ê·¼ íŒ¨í„´ì´ í™•ë¦½ë¨

**KPI ì¸¡ì •**
- ì™¸ë¶€ ì ‘ê·¼ ì‘ë‹µ ì‹œê°„: 10ì´ˆ ì´ë‚´
- ì„œë¹„ìŠ¤ ê°€ìš©ì„±: 99.9% ì´ìƒ
- ì™„ì „í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì²´ì¸ ë™ì‘ ê²€ì¦

---

## ğŸ—ï¸ **ì•„í‚¤í…ì²˜ ì„¤ê³„**

### **ë¬¸ì œ ì§„ë‹¨ ë° í•´ê²° ì „ëµ**
| ë¬¸ì œ ì˜ì—­ | ë°œê²¬ëœ ì´ìŠˆ | ì„ íƒ í•´ê²°ì±… | ì„ íƒ ì´ìœ  |
|----------|-------------|-------------|-----------|
| **kube-proxy** | NodePort ë°”ì¸ë”© ì‹¤íŒ¨ | HostPort + ë§ˆìŠ¤í„°ë…¸ë“œ | NodePort ëŒ€ì‹  ì§ì ‘ ë°”ì¸ë”© |
| **Pod ìŠ¤ì¼€ì¤„ë§** | ì›Œì»¤ë…¸ë“œ ì‹¤í–‰ | nodeSelector + toleration | ë§ˆìŠ¤í„°ë…¸ë“œ ê°•ì œ ë°°ì¹˜ |
| **AWS ë„¤íŠ¸ì›Œí‚¹** | ë³´ì•ˆê·¸ë£¹ ì°¨ë‹¨ | 30080/30300 í¬íŠ¸ ê°œë°© | ìµœì†Œ ê¶Œí•œ ì ‘ê·¼ ì œì–´ |
| **ë„¤íŠ¸ì›Œí¬ ì •ì±…** | ë§ˆìŠ¤í„° ë…¸ë“œ taint | toleration ì¶”ê°€ | ì‹œìŠ¤í…œ Pod ì˜ˆì™¸ ì²˜ë¦¬ |

### **ìµœì¢… ë„¤íŠ¸ì›Œí‚¹ ì•„í‚¤í…ì²˜**
```mermaid
graph TB
    subgraph "AWS Cloud"
        A[Internet] --> B[AWS Security Group<br/>30080, 30300 OPEN]
        B --> C[Master Node EC2<br/>13.125.111.138]
    end
    
    subgraph "Master Node (ip-10-0-1-74)"
        C --> D[HostPort 30080<br/>productpage]
        C --> E[HostPort 30300<br/>grafana]
    end
    
    subgraph "Kubernetes Cluster"
        D --> F[productpage Pod<br/>10.244.246.7:9080]
        E --> G[grafana Pod<br/>10.244.246.8:3000]
        
        F --> H[details Service]
        F --> I[reviews Service]  
        I --> J[ratings Service]
    end
    
    subgraph "Monitoring Stack"
        G --> K[Prometheus<br/>ë©”íŠ¸ë¦­ ìˆ˜ì§‘]
        K --> L[AlertManager<br/>ì•Œë¦¼ ê´€ë¦¬]
    end
```

### **í•µì‹¬ ì„¤ê³„ ê²°ì •**
1. **HostPort vs NodePort**: Self-managed í™˜ê²½ì—ì„œ HostPortê°€ ë” ì•ˆì •ì 
2. **ë§ˆìŠ¤í„°ë…¸ë“œ í™œìš©**: Public IP ë³´ìœ í•œ ìœ ì¼í•œ ë…¸ë“œ í™œìš©
3. **ìµœì†Œ ê¶Œí•œ ë³´ì•ˆ**: í•„ìš”í•œ í¬íŠ¸ë§Œ ì„ ë³„ì  ê°œë°©
4. **Pod ë°°ì¹˜ ì œì–´**: nodeSelector + tolerationì„ í†µí•œ ì •ë°€ ìŠ¤ì¼€ì¤„ë§

---

## ğŸ› ï¸ **Action (ì•¡ì…˜)**

### **Phase 1: ë„¤íŠ¸ì›Œí‚¹ ë¬¸ì œ ì§„ë‹¨ (15ë¶„)**

**í˜„ìƒ ë¶„ì„**
```bash
# NodePort ì„œë¹„ìŠ¤ ì„¤ì • í™•ì¸
kubectl get svc --all-namespaces | grep NodePort
# bookinfo/productpage: 9080:30080/TCP âœ…
# monitoring/prometheus-grafana: 80:30300/TCP âœ…

# í¬íŠ¸ ë°”ì¸ë”© ìƒíƒœ í™•ì¸  
ss -tlnp | grep -E "30080|30300"
# ê²°ê³¼: ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠìŒ âŒ

# iptables ê·œì¹™ í™•ì¸
sudo iptables -t nat -L | grep -E "30080|30300"  
# ê²°ê³¼: ê·œì¹™ ì—†ìŒ âŒ
```

**ê·¼ë³¸ ì›ì¸ ê·œëª…**
- **kube-proxy ì„¤ì • ë¬¸ì œ**: nodePortAddresses null ìƒíƒœ
- **Self-managed í™˜ê²½ ì œì•½**: kubelet API ì ‘ê·¼ ì œí•œìœ¼ë¡œ ë¡œê·¸ í™•ì¸ ë¶ˆê°€
- **ë„¤íŠ¸ì›Œí¬ ì •ì±…**: Pod IP ì§ì ‘ ì ‘ê·¼ë„ ì‹¤íŒ¨

### **Phase 2: kube-proxy ì„¤ì • ìˆ˜ì • ì‹œë„ (10ë¶„)**

**ConfigMap íŒ¨ì¹˜ ì ìš©**
```bash
# kube-proxy ì„¤ì • ë°±ì—…
kubectl get configmap kube-proxy -n kube-system -o yaml > kube-proxy-config.yaml

# í•µì‹¬ ì„¤ì • ìˆ˜ì •
kubectl patch configmap kube-proxy -n kube-system --type merge -p '{
  "data": {
    "config.conf": "nodePortAddresses: []\nlocalhostNodePorts: false\n..."
  }
}'

# kube-proxy Pod ì¬ì‹œì‘
kubectl delete pods -n kube-system -l k8s-app=kube-proxy
```

**ê²°ê³¼ ê²€ì¦**
```bash
# ìƒˆë¡œìš´ Pod í™•ì¸
kubectl get pods -n kube-system | grep kube-proxy
# kube-proxy-dnswb, kube-proxy-wb7jp, kube-proxy-z4bv8 ëª¨ë‘ Running âœ…

# í¬íŠ¸ ë°”ì¸ë”© ì¬í™•ì¸
ss -tlnp | grep -E "30080|30300"
# ì—¬ì „íˆ ë°”ì¸ë”© ì•ˆë¨ âŒ
```

### **Phase 3: HostPort ì „ëµìœ¼ë¡œ ì „í™˜ (20ë¶„)**

**productpage HostPort ì„¤ì •**
```bash
# Deploymentì— HostPort ì¶”ê°€
kubectl patch deployment productpage-v1 -n bookinfo --type='json' -p='[{
  "op": "add", 
  "path": "/spec/template/spec/containers/0/ports", 
  "value": [{"containerPort": 9080, "hostPort": 30080}]
}]'

# ë§ˆìŠ¤í„°ë…¸ë“œ ê°•ì œ ìŠ¤ì¼€ì¤„ë§
kubectl patch deployment productpage-v1 -n bookinfo --type='json' -p='[{
  "op": "add",
  "path": "/spec/template/spec/nodeSelector", 
  "value": {"node-role.kubernetes.io/control-plane": ""}
}]'
```

**taint ë¬¸ì œ í•´ê²°**
```bash
# ë§ˆìŠ¤í„°ë…¸ë“œ taint í™•ì¸
kubectl describe node ip-10-0-1-74 | grep -i taint
# Taints: node-role.kubernetes.io/control-plane:NoSchedule âœ…

# toleration ì¶”ê°€
kubectl patch deployment productpage-v1 -n bookinfo --type='json' -p='[{
  "op": "add",
  "path": "/spec/template/spec/tolerations",
  "value": [{
    "key": "node-role.kubernetes.io/control-plane",
    "operator": "Exists",
    "effect": "NoSchedule"
  }]
}]'
```

**ì„±ê³µì  ë°°ì¹˜ í™•ì¸**
```bash
kubectl get pods -n bookinfo -o wide | grep productpage
# productpage-v1-569f8b9944-r2g9h  1/1  Running  0  3m5s  10.244.246.7  ip-10-0-1-74 âœ…
```

### **Phase 4: AWS ë³´ì•ˆê·¸ë£¹ ì„¤ì • (5ë¶„)**

**AWS Management Console ì‘ì—…**
1. **EC2 ëŒ€ì‹œë³´ë“œ** â†’ **ì¸ìŠ¤í„´ìŠ¤** ì„ íƒ
2. **ë§ˆìŠ¤í„°ë…¸ë“œ EC2** (ip-10-0-1-74) ì„ íƒ  
3. **ë³´ì•ˆ** íƒ­ â†’ **ë³´ì•ˆ ê·¸ë£¹** í´ë¦­
4. **ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘**

**ì¶”ê°€ëœ ê·œì¹™**
```
ê·œì¹™ 1:
- ìœ í˜•: Custom TCP
- í¬íŠ¸: 30080  
- ì†ŒìŠ¤: 0.0.0.0/0
- ì„¤ëª…: Bookinfo ProductPage

ê·œì¹™ 2:
- ìœ í˜•: Custom TCP
- í¬íŠ¸: 30300
- ì†ŒìŠ¤: 0.0.0.0/0  
- ì„¤ëª…: Grafana Dashboard
```

### **Phase 5: Grafana ë§ˆìŠ¤í„°ë…¸ë“œ ì´ë™ (10ë¶„)**

**Grafanaë„ ë§ˆìŠ¤í„°ë…¸ë“œë¡œ ë°°ì¹˜**
```bash
# nodeSelector + toleration ë™ì‹œ ì ìš©
kubectl patch deployment prometheus-grafana -n monitoring --type='json' -p='[
  {
    "op": "add",
    "path": "/spec/template/spec/nodeSelector",
    "value": {"node-role.kubernetes.io/control-plane": ""}
  },
  {
    "op": "add", 
    "path": "/spec/template/spec/tolerations",
    "value": [{
      "key": "node-role.kubernetes.io/control-plane",
      "operator": "Exists",
      "effect": "NoSchedule"
    }]
  }
]'
```

**ì¬ìŠ¤ì¼€ì¤„ë§ í™•ì¸**
```bash
kubectl get pods -n monitoring -o wide | grep grafana
# prometheus-grafana-85ccbd75c-gbf6j  3/3  Running  0  85s  10.244.246.8  ip-10-0-1-74 âœ…
```

### **Phase 6: Grafana í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²° (30ë¶„)**

**ë¬¸ì œ ë°œê²¬**
ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ Grafana Dashboards ì ‘ê·¼ ì‹œ **"An error occurred within the plugin"** ì—ëŸ¬ ë°œìƒ

**ê·¼ë³¸ ì›ì¸ ì§„ë‹¨**
```bash
# Grafana ë¡œê·¸ ë¶„ì„
kubectl logs -n monitoring $(kubectl get pods -n monitoring | grep grafana | awk '{print $1}') -c grafana --tail=50

# í•µì‹¬ ì—ëŸ¬ íŒ¨í„´ ë°œê²¬:
# dial tcp 10.109.152.224:9090: i/o timeout
# Grafana â†’ Prometheus ì—°ê²° 10ì´ˆ íƒ€ì„ì•„ì›ƒ ì§€ì† ë°œìƒ
```

**ë„¤íŠ¸ì›Œí‚¹ ë¬¸ì œ ì‹ë³„**
- **Grafana**: ë§ˆìŠ¤í„°ë…¸ë“œ (ip-10-0-1-74)ì—ì„œ ì‹¤í–‰ âœ…  
- **Prometheus**: ì›Œì»¤ë…¸ë“œ (ip-10-0-2-208)ì—ì„œ ì‹¤í–‰ âŒ
- **ë¬¸ì œ**: ë§ˆìŠ¤í„°ë…¸ë“œ â†”ï¸ ì›Œì»¤ë…¸ë“œ ê°„ Pod í†µì‹  ì‹¤íŒ¨ (Self-managed í™˜ê²½ ì œì•½)

**í•´ê²° ì „ëµ: Prometheus ë§ˆìŠ¤í„°ë…¸ë“œ ì´ë™**
```bash
# Prometheus Custom Resource ìˆ˜ì • (nodeSelector)
kubectl patch prometheus prometheus-kube-prometheus-prometheus -n monitoring --type='json' -p='[{
  "op": "add", 
  "path": "/spec/nodeSelector", 
  "value": {"node-role.kubernetes.io/control-plane": ""}
}]'

# Prometheus Custom Resource ìˆ˜ì • (toleration)
kubectl patch prometheus prometheus-kube-prometheus-prometheus -n monitoring --type='json' -p='[{
  "op": "add",
  "path": "/spec/tolerations",
  "value": [{
    "key": "node-role.kubernetes.io/control-plane",
    "operator": "Exists", 
    "effect": "NoSchedule"
  }]
}]'

# ê¸°ì¡´ Pod ì‚­ì œí•˜ì—¬ ì¬ìƒì„± ìœ ë„
kubectl delete pod prometheus-prometheus-kube-prometheus-prometheus-0 -n monitoring
```

**ì„±ê³µì  í•´ê²° ê²€ì¦**
```bash
# ìƒˆë¡œìš´ Prometheus Pod ìœ„ì¹˜ í™•ì¸
kubectl get pods -n monitoring prometheus-prometheus-kube-prometheus-prometheus-0 -o wide
# prometheus-prometheus-kube-prometheus-prometheus-0  2/2  Running  0  82s  10.244.246.9  ip-10-0-1-74 âœ…

# Prometheus API ì—°ê²°ì„± í…ŒìŠ¤íŠ¸
curl -s http://10.244.246.9:9090/-/healthy
# ì •ìƒ ì‘ë‹µ í™•ì¸ âœ…
```

**ìµœì¢… ê²°ê³¼: ì™„ì „ í•´ê²°**
- âœ… **Grafana í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ ì™„ì „ í•´ê²°**
- âœ… **ëª¨ë“  ëŒ€ì‹œë³´ë“œ ì •ìƒ ë¡œë“œ**  
- âœ… **ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ì‹œê°í™” ì™„ë²½ ë™ì‘**

---

## ğŸ“Š **Result (ê²°ê³¼)**

### **ì •ëŸ‰ì  ì„±ê³¼**

### **ì™¸ë¶€ ì ‘ê·¼ ì„±ê³µ ê²€ì¦**

**âœ… Bookinfo ì• í”Œë¦¬ì¼€ì´ì…˜ ì™„ì „ ì„±ê³µ**
```bash
curl -I http://13.125.111.138:30080/productpage --max-time 10
# HTTP/1.1 200 OK âœ…
# Server: Werkzeug/2.2.3 Python/3.7.7 âœ…  
# Content-Length: 3769 âœ…
# ì™„ì „í•œ HTML í˜ì´ì§€ ì‘ë‹µ í™•ì¸
```

**âœ… Grafana ëŒ€ì‹œë³´ë“œ ì™„ì „ ì„±ê³µ**  
```bash
curl -I http://13.125.111.138:30300 --max-time 10
# HTTP/1.1 302 Found âœ…
# Location: /login âœ…
# X-Content-Type-Options: nosniff âœ…
# ì •ìƒì ì¸ ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸
```

### **ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì²´ì¸ ê²€ì¦**
```bash
kubectl get jobs -n bookinfo
# NAME: traffic-gen  STATUS: Complete  COMPLETIONS: 1/1 âœ…
# 50íšŒ HTTP ìš”ì²­ ëª¨ë‘ ì„±ê³µ ì™„ë£Œ
```

**ì„œë¹„ìŠ¤ ì²´ì¸ ë™ì‘ íŒ¨í„´:**
```
productpage (50 requests) âœ…
â”œâ”€â”€ details (50 requests) - Ruby ì„œë¹„ìŠ¤ âœ…
â””â”€â”€ reviews (50 requests) âœ…  
    â”œâ”€â”€ v1: ~17 requests (ratings í˜¸ì¶œ ì—†ìŒ) âœ…
    â”œâ”€â”€ v2: ~17 requests â†’ ratings (~17 requests) âœ…
    â””â”€â”€ v3: ~16 requests â†’ ratings (~16 requests) âœ…
```

### **âœ… Grafana í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ ì™„ì „ í•´ê²°**

**ë¬¸ì œ í•´ê²° ì „/í›„ ë¹„êµ**
- **ì´ì „**: "An error occurred within the plugin" ì—ëŸ¬ë¡œ ëŒ€ì‹œë³´ë“œ ì ‘ê·¼ ë¶ˆê°€ âŒ
- **í˜„ì¬**: ëª¨ë“  ëŒ€ì‹œë³´ë“œ ì™„ë²½ ë™ì‘, ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ì‹œê°í™” âœ…

**ğŸ¯ ì„±ê³µí•œ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ìŠ¤í¬ë¦°ìƒ·**

### **1. CoreDNS ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ (í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²° ì„±ê³¼)**
![CoreDNS Dashboard](../images/CoreDNS.png)

### **2. Kubernetes API Server ëŒ€ì‹œë³´ë“œ (í´ëŸ¬ìŠ¤í„° í•µì‹¬ ìƒíƒœ)**
![Kubernetes API Server](../images/Kubernetes-API%20server.png)

### **3. Prometheus Overview (ì „ì²´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ)**
![Prometheus Overview](../images/Prometheus-%20Overview.png)

**âœ… í™•ì¸ëœ ëŒ€ì‹œë³´ë“œ ë™ì‘ ì„±ê³¼:**

**ğŸ¯ CoreDNS ëŒ€ì‹œë³´ë“œ (í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²° ì™„ë£Œ):**
- **DNS ìš”ì²­ëŸ‰**: 40 mp/sì˜ ì•ˆì •ì ì¸ ì²˜ë¦¬ ì„±ëŠ¥
- **ì‘ë‹µ ì‹œê°„**: í‰ê·  4ms ì´í•˜ì˜ ë¹ ë¥¸ DNS ì‘ë‹µ
- **ì¿¼ë¦¬ íƒ€ì… ë¶„ì„**: A, AAAA, other ë ˆì½”ë“œë³„ ì‹¤ì‹œê°„ í†µê³„
- **í”„ë¡œí† ì½œ ë¶„ì„**: UDP/TCP íŠ¸ë˜í”½ íŒ¨í„´ ì™„ë²½ ì‹œê°í™”
- **ì—ëŸ¬ìœ¨**: 0%ì˜ ì™„ë²½í•œ DNS ì„œë¹„ìŠ¤ í’ˆì§ˆ

**ğŸ¯ Kubernetes API Server ëŒ€ì‹œë³´ë“œ (í´ëŸ¬ìŠ¤í„° ì½”ì–´ ìƒíƒœ):**
- **API ìš”ì²­ ì²˜ë¦¬**: ì´ˆë‹¹ ìˆ˜ì‹­ ê±´ì˜ API í˜¸ì¶œ ì•ˆì •ì  ì²˜ë¦¬
- **ì‘ë‹µ ì‹œê°„ ë¶„í¬**: P99 ì‘ë‹µì‹œê°„ 100ms ì´í•˜ ìœ ì§€
- **HTTP ìƒíƒœ ì½”ë“œ**: 200 OK ì‘ë‹µë¥  99% ì´ìƒ
- **ì›Œí¬ë¡œë“œ ìƒíƒœ**: ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ì •ìƒ ë™ì‘ í™•ì¸
- **etcd ì—°ê²°ì„±**: í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì €ì¥ì†Œ ì™„ë²½ ì—°ë™

**ğŸ¯ Prometheus Overview (ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ì „ì²´):**
- **íƒ€ê²Ÿ ìˆ˜ì§‘ ìƒíƒœ**: 15+ íƒ€ê²Ÿ ëª¨ë‘ UP ìƒíƒœ
- **ë©”íŠ¸ë¦­ ì²˜ë¦¬ëŸ‰**: ì´ˆë‹¹ ìˆ˜ì²œ ê°œ ë©”íŠ¸ë¦­ ì•ˆì •ì  ìˆ˜ì§‘
- **ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰**: TSDB íš¨ìœ¨ì  ì••ì¶• ë° ë³´ê´€
- **ì¿¼ë¦¬ ì„±ëŠ¥**: ëŒ€ì‹œë³´ë“œ ì¿¼ë¦¬ 1ì´ˆ ì´ë‚´ ì‘ë‹µ
- **ìŠ¤í¬ë˜í•‘ ì„±ê³µë¥ **: 99.9% ì´ìƒì˜ ë°ì´í„° ìˆ˜ì§‘ ì‹ ë¢°ì„±

**Prometheus ì—°ê²° ë³µêµ¬ ê²€ì¦**
```bash
# Prometheus ë§ˆìŠ¤í„°ë…¸ë“œ ì´ë™ í›„ ì—°ê²° í…ŒìŠ¤íŠ¸
curl -s http://10.244.246.9:9090/-/healthy
# ì‘ë‹µ: "Prometheus is Healthy." âœ…

# Grafana â†’ Prometheus ë°ì´í„°ì†ŒìŠ¤ ì—°ê²° ìƒíƒœ
# Status: Working âœ… 
# 10ì´ˆ íƒ€ì„ì•„ì›ƒ ì—ëŸ¬ ì™„ì „ í•´ê²°
```

### **ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ í˜„í™©**
| ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | Pod ìˆ˜ | ë§ˆìŠ¤í„°ë…¸ë“œ ë°°ì¹˜ | ìƒíƒœ | ì™¸ë¶€ ì ‘ê·¼ | ì¶”ê°€ ì„±ê³¼ |
|-------------|--------|----------------|------|-----------|-----------|
| **monitoring** | 8ê°œ | grafana, prometheus (2ê°œ) | **ì™„ì „ ë™ì‘** | 30300 í¬íŠ¸ âœ… | **í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²°** âœ… |
| **bookinfo** | 7ê°œ | productpage (1ê°œ) | ì™„ì „ ë™ì‘ | 30080 í¬íŠ¸ âœ… | ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì²´ì¸ ì™„ì„± |
| **linkerd** | 3ê°œ | identityë§Œ ì •ìƒ | ë¶€ë¶„ ë™ì‘ | - | í–¥í›„ ê°œì„  ëŒ€ìƒ |

**í•µì‹¬ ê°œì„ ì‚¬í•­:**
- **Prometheus ë§ˆìŠ¤í„°ë…¸ë“œ ì´ë™**: ì›Œì»¤ë…¸ë“œ â†’ ë§ˆìŠ¤í„°ë…¸ë“œ (ë„¤íŠ¸ì›Œí‚¹ ì œì•½ ê·¹ë³µ)
- **Grafana-Prometheus ì—°ê²° ë³µêµ¬**: 10ì´ˆ íƒ€ì„ì•„ì›ƒ ì—ëŸ¬ â†’ ì™„ì „ í•´ê²°
- **ëª¨ë“  ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ í†µí•©**: ë§ˆìŠ¤í„°ë…¸ë“œì—ì„œ ì¼ê´€ëœ ìš´ì˜

### **ë„¤íŠ¸ì›Œí¬ ì•„í‚¤í…ì²˜ ìµœì¢… ìƒíƒœ**
- **Public ì ‘ê·¼**: 13.125.111.138:30080, 30300 âœ…
- **HostPort ë°”ì¸ë”©**: ë§ˆìŠ¤í„°ë…¸ë“œì—ì„œ ì§ì ‘ ë°”ì¸ë”© âœ…  
- **Pod ìŠ¤ì¼€ì¤„ë§**: ì „ëµì  ë§ˆìŠ¤í„°ë…¸ë“œ ë°°ì¹˜ âœ…
- **ë³´ì•ˆ ì •ì±…**: ìµœì†Œ ê¶Œí•œ í¬íŠ¸ ê°œë°© âœ…

---

## ğŸ” **ê¸°ìˆ ì  ì¸ì‚¬ì´íŠ¸**

### **Self-managed vs Managed í™˜ê²½ ë„¤íŠ¸ì›Œí‚¹**

**Self-managed íŠ¹ìˆ˜ì„±**
1. **kube-proxy ì œì•½**: Managed í™˜ê²½ê³¼ ë‹¬ë¦¬ NodePort ë°”ì¸ë”© ë³µì¡ì„±
2. **ë„¤íŠ¸ì›Œí¬ ì •ì±…**: Pod ë„¤íŠ¸ì›Œí¬ì™€ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ê°„ ê²©ë¦¬ ê°•í™”
3. **kubelet API ì œí•œ**: ë””ë²„ê¹… ë° ë¡œê·¸ ì ‘ê·¼ ì œì•½

**í•´ê²°ëœ íŒ¨í„´**
- **HostPort + nodeSelector**: NodePort ëŒ€ì‹  ë” ì§ì ‘ì ì¸ ì ‘ê·¼
- **toleration í™œìš©**: ì‹œìŠ¤í…œ ì œì•½ì„ ìœ ì—°í•˜ê²Œ ìš°íšŒ  
- **AWS ë„¤ì´í‹°ë¸Œ í†µí•©**: ë³´ì•ˆê·¸ë£¹ê³¼ Kubernetes ë„¤íŠ¸ì›Œí‚¹ ì¡°í•©

### **ë§ˆìŠ¤í„°ë…¸ë“œ í™œìš© ì „ëµ**

**ì¥ì :**
1. **Public IP ë³´ì¥**: ìœ ì¼í•œ ì™¸ë¶€ ì ‘ê·¼ ì—”ë“œí¬ì¸íŠ¸
2. **ë†’ì€ ê°€ìš©ì„±**: ë§ˆìŠ¤í„°ë…¸ë“œëŠ” í•­ìƒ Running ìƒíƒœ ìœ ì§€
3. **ë„¤íŠ¸ì›Œí¬ ìš°ì„ ìˆœìœ„**: í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì˜ ì¤‘ì‹¬ì 

**ê³ ë ¤ì‚¬í•­:**
1. **ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰**: ë§ˆìŠ¤í„°ë…¸ë“œ ë¶€í•˜ ì¦ê°€ (í—ˆìš© ê°€ëŠ¥í•œ ìˆ˜ì¤€)
2. **ë‹¨ì¼ ì¥ì• ì **: Public IP ì˜ì¡´ì„± (í˜„ì¬ í™˜ê²½ì—ì„œëŠ” ì ì ˆ)
3. **í™•ì¥ì„±**: ì¶”í›„ ë‹¤ì¤‘ ë§ˆìŠ¤í„° í™˜ê²½ì—ì„œ ë¡œë“œë°¸ëŸ°ì„œ í•„ìš”

### **AWS ë³´ì•ˆê·¸ë£¹ + Kubernetes í†µí•© íŒ¨í„´**

**ê³„ì¸µë³„ ë³´ì•ˆ:**
1. **AWS ë ˆë²¨**: ë³´ì•ˆê·¸ë£¹ì—ì„œ í¬íŠ¸ ë ˆë²¨ ì œì–´
2. **Kubernetes ë ˆë²¨**: Service, NetworkPolicy ì œì–´  
3. **ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨**: ì¸ì¦/ì¸ê°€ (Grafana ë¡œê·¸ì¸)

**ìš´ì˜ í¸ì˜ì„±:**
- **ìµœì†Œ í¬íŠ¸ ê°œë°©**: 30080, 30300ë§Œ ì„ ë³„ì  ë…¸ì¶œ
- **ì†ŒìŠ¤ ì œí•œ ê°€ëŠ¥**: í•„ìš”ì‹œ íŠ¹ì • IP ëŒ€ì—­ìœ¼ë¡œ ì œí•œ ê°€ëŠ¥
- **Terraform ê´€ë¦¬**: Infrastructure as Codeë¡œ ë³´ì•ˆê·¸ë£¹ ê´€ë¦¬

---

## ğŸ“ˆ **ì„±ëŠ¥ ë° í™•ì¥ì„± ë¶„ì„**

### **ì‘ë‹µ ì„±ëŠ¥**
| ì„œë¹„ìŠ¤ | ì‘ë‹µ ì‹œê°„ | ìƒíƒœ ì½”ë“œ | ì»¨í…ì¸  í¬ê¸° | ë¹„ê³  |
|--------|-----------|-----------|-------------|------|
| **Bookinfo** | ~1ì´ˆ | HTTP 200 | 3769 bytes | ì™„ì „í•œ HTML í˜ì´ì§€ |
| **Grafana** | ~0.5ì´ˆ | HTTP 302 | Redirect | ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ |

### **í™•ì¥ì„± ê³ ë ¤ì‚¬í•­**

**ìˆ˜í‰ í™•ì¥:**
- **Multi-AZ ë°°í¬**: ë‹¤ì¤‘ ê°€ìš©ì˜ì—­ì—ì„œ ì›Œì»¤ë…¸ë“œ í™•ì¥
- **ë¡œë“œë°¸ëŸ°ì„œ ë„ì…**: ALB/NLBë¥¼ í†µí•œ ë§ˆìŠ¤í„°ë…¸ë“œ ë¶€í•˜ ë¶„ì‚°
- **Auto Scaling**: Pod ìˆ˜í‰ í™•ì¥ ë° ë…¸ë“œ ìë™ í™•ì¥

**ìˆ˜ì§ í™•ì¥:**  
- **ë§ˆìŠ¤í„°ë…¸ë“œ ì¸ìŠ¤í„´ìŠ¤ ì—…ê·¸ë ˆì´ë“œ**: t3.medium â†’ t3.large
- **ë¦¬ì†ŒìŠ¤ limits ì¡°ì •**: CPU/Memory ì œí•œ ìµœì í™”
- **ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­**: Enhanced Networking í™œì„±í™”

### **ëª¨ë‹ˆí„°ë§ ë©”íŠ¸ë¦­**
- **ì™¸ë¶€ ì ‘ê·¼ ì§€ì—°ì‹œê°„**: CloudWatch + Prometheus ì´ì¤‘ ìˆ˜ì§‘
- **ë§ˆìŠ¤í„°ë…¸ë“œ ë¦¬ì†ŒìŠ¤**: CPU/Memory ì‚¬ìš©ë¥  ëª¨ë‹ˆí„°ë§  
- **ë„¤íŠ¸ì›Œí¬ ì²˜ë¦¬ëŸ‰**: HostPort íŠ¸ë˜í”½ íŒ¨í„´ ë¶„ì„

---

## ğŸ¯ **ë‹¤ìŒ ë‹¨ê³„ ì¤€ë¹„ì‚¬í•­**

### **ì¦‰ì‹œ ê°€ëŠ¥í•œ ê°œì„ ì‚¬í•­**
1. **Linkerd ì™„ì „ í•´ê²°**
   - [ ] CrashLoopBackOff ê·¼ë³¸ ì›ì¸ ë¶„ì„
   - [ ] mTLS ìë™ ì•”í˜¸í™” í™œì„±í™”
   - [ ] ì„œë¹„ìŠ¤ ë©”ì‹œ ê³ ê¸‰ ê¸°ëŠ¥ êµ¬í˜„

2. **ë³´ì•ˆ ê°•í™”**
   - [ ] Grafana HTTPS ì„¤ì •
   - [ ] ë³´ì•ˆê·¸ë£¹ ì†ŒìŠ¤ IP ì œí•œ
   - [ ] Network Policy ë„ì…

3. **ëª¨ë‹ˆí„°ë§ ê³ ë„í™”**
   - [ ] ì»¤ìŠ¤í…€ Grafana ëŒ€ì‹œë³´ë“œ êµ¬ì„±
   - [ ] Bookinfo ì• í”Œë¦¬ì¼€ì´ì…˜ ë©”íŠ¸ë¦­ ì‹œê°í™”
   - [ ] AlertManager ê·œì¹™ ì •ì˜

### **ì¥ê¸° ë¡œë“œë§µ**
4. **ë¶„ì‚° íŠ¸ë ˆì´ì‹±**
   - [ ] Jaeger ì„¤ì¹˜ ë° ì—°ë™
   - [ ] ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŠ¸ë ˆì´ì‹± êµ¬ì„±
   - [ ] ì„±ëŠ¥ ë³‘ëª© ì§€ì  ì‹ë³„

5. **CI/CD íŒŒì´í”„ë¼ì¸**
   - [ ] GitHub Actions ì›Œí¬í”Œë¡œìš° êµ¬í˜„
   - [ ] Infrastructure as Code ì™„ì „ ìë™í™”
   - [ ] í…ŒìŠ¤íŠ¸ ìë™í™” (Unit + Integration)

6. **ë¬¸ì„œí™” ë° ìš´ì˜**
   - [ ] ìš´ì˜ ê°€ì´ë“œ ì‘ì„±
   - [ ] íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ
   - [ ] ì„±ëŠ¥ íŠœë‹ ê°€ì´ë“œ

---

## ğŸ’¡ **í•µì‹¬ í•™ìŠµ í¬ì¸íŠ¸**

### **ê¸°ìˆ ì  ì„±ì¥**
1. **ë³µí•© ë¬¸ì œ í•´ê²°**: AWS + Kubernetes + ë„¤íŠ¸ì›Œí‚¹ í†µí•© ì´ìŠˆ
2. **ëŒ€ì•ˆì  ì‚¬ê³ **: NodePort ì‹¤íŒ¨ â†’ HostPort ì „í™˜ì˜ ì°½ì˜ì  ì ‘ê·¼
3. **ì‹œìŠ¤í…œ ì„¤ê³„**: ì œì•½ì‚¬í•­ì„ ê°•ì ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ì•„í‚¤í…ì²˜ ì„¤ê³„

### **ìš´ì˜ ê´€ì  ì¸ì‚¬ì´íŠ¸**  
1. **ì ì§„ì  ê²€ì¦**: ê° ë‹¨ê³„ë³„ ì„±ê³µ í™•ì¸ í›„ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰
2. **ë¬¸ì œ ê²©ë¦¬**: ë„¤íŠ¸ì›Œí¬/ë³´ì•ˆ/ìŠ¤ì¼€ì¤„ë§ ë¬¸ì œë¥¼ ê°œë³„ì ìœ¼ë¡œ í•´ê²°
3. **ì‹¤ë¬´ ì ìš©ì„±**: ì´ë¡ ì  ì„¤ì •ë³´ë‹¤ ì‹¤ì œ ë™ì‘í•˜ëŠ” ì†”ë£¨ì…˜ ìš°ì„ 

### **Self-managed í™˜ê²½ ì „ë¬¸ì„±**
1. **ì œì•½ì‚¬í•­ ì´í•´**: Managed ì„œë¹„ìŠ¤ì™€ì˜ ì°¨ì´ì  ëª…í™•í•œ ì¸ì‹
2. **ìš°íšŒ ì „ëµ**: ì œí•œì‚¬í•­ì„ ê·¹ë³µí•˜ëŠ” ë‹¤ì–‘í•œ ê¸°ìˆ ì  ë°©ë²•ë¡ 
3. **ìš´ì˜ íš¨ìœ¨ì„±**: ë§¤ì¼ ë°˜ë³µ ê°€ëŠ¥í•œ ì•ˆì •ì  êµ¬ì¶• í”„ë¡œì„¸ìŠ¤

### **Grafana í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²°ì—ì„œ ì–»ì€ ì¸ì‚¬ì´íŠ¸**
1. **ë¡œê·¸ ê¸°ë°˜ ë¬¸ì œ ì§„ë‹¨**: ì—ëŸ¬ ë©”ì‹œì§€ íŒ¨í„´ ë¶„ì„ì„ í†µí•œ ê·¼ë³¸ ì›ì¸ íŒŒì•…
2. **Prometheus Operator ì´í•´**: StatefulSet ì§ì ‘ ìˆ˜ì • ëŒ€ì‹  Custom Resource í™œìš©
3. **Pod ê°„ ë„¤íŠ¸ì›Œí‚¹ ì´í•´**: Self-managed í™˜ê²½ì—ì„œ ë…¸ë“œ ê°„ í†µì‹  ì œì•½ ì¸ì‹
4. **í†µí•© ìš´ì˜ ì „ëµ**: ê´€ë ¨ ì„œë¹„ìŠ¤ë“¤ì„ ë™ì¼í•œ ë…¸ë“œì— ë°°ì¹˜í•˜ì—¬ ë³µì¡ì„± ê°ì†Œ

---

### **âœ… ì²¨ë¶€ëœ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ ìŠ¤í¬ë¦°ìƒ·**

**1. CoreDNS.png** 
- **ìœ„ì¹˜**: `docs/images/CoreDNS.png`
- **ëª©ì **: Grafana í”ŒëŸ¬ê·¸ì¸ ì—ëŸ¬ í•´ê²° ì„±ê³¼ ì¦ëª…
- **ë‚´ìš©**: DNS ìš”ì²­ëŸ‰, ì‘ë‹µì‹œê°„, ì¿¼ë¦¬ íƒ€ì… ë¶„ì„ ë“± ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­

**2. Kubernetes-API server.png**
- **ìœ„ì¹˜**: `docs/images/Kubernetes-API server.png` 
- **ëª©ì **: Kubernetes í´ëŸ¬ìŠ¤í„° í•µì‹¬ ìƒíƒœ ëª¨ë‹ˆí„°ë§
- **ë‚´ìš©**: API ì„œë²„ ìš”ì²­ ì²˜ë¦¬ëŸ‰, ì‘ë‹µì‹œê°„, ì—ëŸ¬ìœ¨ ë“±

**3. Prometheus- Overview.png**  
- **ìœ„ì¹˜**: `docs/images/Prometheus- Overview.png`
- **ëª©ì **: ì „ì²´ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸
- **ë‚´ìš©**: Prometheus ìì²´ ë©”íŠ¸ë¦­, íƒ€ê²Ÿ ìƒíƒœ, ì €ì¥ì†Œ ì‚¬ìš©ëŸ‰ ë“±